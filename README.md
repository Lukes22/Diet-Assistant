# 食友记 - 记录美食，分享健康

## 产品简介

**食友记**是一款融合 AI 智能分析与社交互动的健康饮食管理应用。用户不仅可以通过自然语言描述饮食内容，获得 AI 实时计算的卡路里分析和专业营养建议，还能与好友分享饮食记录、互相监督鼓励，让健康管理充满乐趣。

产品核心理念：**记录美食，分享健康**——让每一餐都有迹可循，让健康之路不再孤单。

## 功能介绍

### 一、AI 智能饮食分析

1. **自然语言识别**
   - 支持口语化输入，如"两个包子，一杯豆浆，一个煎蛋"
   - AI 自动识别食物种类、数量和烹饪方式
   - 精准计算每种食物及总卡路里

2. **智能澄清机制**
   - 对模糊描述智能识别（如"米饭"未说明份量）
   - 弹出选择卡片让用户确认：小碗/中碗/大碗
   - 避免计算误差，提升准确性

3. **形象化热量展示**
   - 将卡路里换算为日常参照物
   - 相当于 X 瓶可乐
   - 相当于 X 碗米饭
   - 需要跑步 X 公里消耗

4. **专业营养评估**
   - 基于《中国居民膳食指南》评估
   - 0-100 分健康评分
   - 针对性营养改善建议

5. **AI 咨询助手**
   - 支持饮食健康相关问答
   - 个性化饮食建议
   - 用户可对 AI 回答点赞点踩反馈

### 二、个人饮食管理

1. **用户系统**
   - 注册登录，个人信息管理
   - 设置身高、体重、健康目标（减重/增肌/保持）
   - AI 根据用户目标给出定制化建议

2. **饮食记录**
   - 自动保存每次饮食分析结果
   - 一周饮食记录可视化展示
   - 支持删除和修改历史记录
   - 按早餐/午餐/晚餐/零食分类

### 三、社交互动功能

1. **好友系统**
   - 每位用户拥有唯一邀请码
   - 通过邀请码添加好友
   - 查看好友一周饮食记录
   - 互相监督，共同进步

2. **留言互动**
   - 给好友留言鼓励
   - 对好友饮食记录点赞/点踩
   - 留言实时通知

3. **分享功能**
   - 分享 AI 分析结果给好友
   - 健康之路，结伴同行

### 四、管理后台

1. **数据统计**
   - 用户总数及新增趋势
   - 饮食记录统计
   - AI 反馈统计（好评/差评）

2. **用户管理**
   - 查看用户列表
   - 用户使用情况分析

3. **AI 反馈管理**
   - 查看用户对 AI 回答的评价
   - 收集差评原因，持续优化

## 产品亮点

### 1. AI 驱动的智能体验
采用通义千问大模型（Qwen2.5-32B-Instruct），具备强大的自然语言理解能力，让用户以最自然的方式描述饮食，获得精准分析。

### 2. 社交化健康管理
打破传统健康管理应用的"孤独感"，通过好友系统让用户互相监督、鼓励，让健康管理变成一场有趣的社交活动。

### 3. 形象化数据呈现
将抽象的卡路里数字转化为可乐、米饭、跑步距离等直观参照，让用户对热量摄入有具象认知。

### 4. 专业营养指导
结合《中国居民膳食指南》，提供符合国人饮食习惯的专业建议，而非简单的热量计算。

### 5. 流畅的交互体验
采用流式 API 调用，AI 回复实时显示，打字机效果带来沉浸式对话体验。

### 6. 用户反馈闭环
用户可对 AI 回答进行评价，差评可填写原因，形成产品优化闭环。

## 技术方案特色

### 架构设计

```
┌─────────────────────────────────────────────────────────────┐
│                        前端展示层                            │
│         HTML5 + CSS3 + JavaScript (原生实现)                 │
├─────────────────────────────────────────────────────────────┤
│                        后端服务层                            │
│              Flask + Flask-Login + SQLAlchemy               │
├─────────────────────────────────────────────────────────────┤
│                        数据存储层                            │
│                     SQLite 数据库                            │
├─────────────────────────────────────────────────────────────┤
│                        AI 能力层                             │
│       ModelScope API (Qwen2.5-32B-Instruct 大模型)          │
└─────────────────────────────────────────────────────────────┘
```

### 技术栈

| 层级 | 技术选型 | 说明 |
|------|----------|------|
| 后端框架 | Flask | 轻量级 Python Web 框架 |
| 用户认证 | Flask-Login | 会话管理与用户认证 |
| 数据库 ORM | Flask-SQLAlchemy | 对象关系映射 |
| AI 服务 | ModelScope API | 魔搭大模型推理服务 |
| AI 模型 | Qwen2.5-32B-Instruct | 通义千问指令微调模型 |
| 前端 | 原生 HTML/CSS/JS | 无框架依赖，轻量快速 |
| 部署 | Docker | 容器化部署，环境一致 |

### 技术特色

1. **OpenAI 兼容接口**
   - 使用 OpenAI SDK 调用魔搭 API
   - 便于后续切换不同模型服务

2. **流式响应处理**
   - 采用 streaming 模式调用大模型
   - 实时展示 AI 回复，降低首字延迟

3. **结构化输出解析**
   - 精心设计的 Prompt 引导 AI 输出 JSON
   - 多重解析策略确保数据提取成功

4. **安全配置**
   - API Key 通过环境变量管理
   - 密码哈希存储，保障用户安全

5. **容器化部署**
   - 提供 Dockerfile 一键部署
   - 可直接部署到魔搭创空间

### 项目结构

```
食友记/
├── app.py                 # Flask 主应用
├── models.py              # 数据库模型
├── requirements.txt       # Python 依赖
├── Dockerfile             # 容器配置
├── .env.example           # 环境变量示例
├── static/
│   ├── css/
│   │   └── style.css      # 样式文件
│   └── js/
│       └── app.js         # 前端逻辑
├── templates/
│   ├── index.html         # 主页面
│   ├── auth.html          # 登录注册页
│   ├── settings.html      # 设置页面
│   ├── friends.html       # 好友详情页
│   └── admin.html         # 管理后台
└── doc/
    ├── requirement.md     # 需求文档
    └── upgrade.md         # 升级计划
```

### 数据库设计

| 表名 | 说明 |
|------|------|
| users | 用户信息表 |
| meal_records | 饮食记录表 |
| friendships | 好友关系表 |
| messages | 留言消息表 |
| meal_reactions | 餐食点赞表 |
| ai_feedbacks | AI 反馈表 |

## 使用说明

### 本地运行

1. 克隆项目
```bash
git clone https://github.com/Lukes22/Diet-Assistant.git
cd Diet-Assistant
```

2. 配置环境变量
```bash
cp .env.example .env
# 编辑 .env 文件，填入 MODELSCOPE_API_KEY
```

3. 安装依赖
```bash
pip install -r requirements.txt
```

4. 启动服务
```bash
python app.py
```

5. 访问应用
```
http://localhost:7860
```

### Docker 部署

```bash
docker build -t shiyouji .
docker run -p 7860:7860 -e MODELSCOPE_API_KEY=your_key shiyouji
```

## 演示地址

魔搭创空间：https://modelscope.cn/studios/Lukes22/DIet_Assistant

## 开源协议

MIT License
